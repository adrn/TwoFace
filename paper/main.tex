\documentclass[modern, letterpaper]{aastex61}

% to-do list
% ----------
% - write a first draft of the introduction
% - list our assumptions for detection & characterization (TheJoker)
% - list our assumptions for hierarchical inference

% style notes
% -----------
% - This file generates by Makefile; don't be typing ``pdflatex'' or some bullshit.
% - Line break between sentences to make the git diffs readable.
% - Simple Monte Carlo gets a capital S to indicate that it is a defined thing.
% - Use \, as a multiply operator.
% - Reserve () for function arguments; use [] or {} for outer shit.
% - Always prior pdf or posterior pdf, never prior or posterior (that's your arse).
% - Use \sectionname not Section, \figname not Figure, \documentname not Article or Paper or paper.
% - Hyphenate binary-star when it is an adjective, not when it is a noun!

\include{gitstuff}
\include{preamble}

% adjust ASS-TEX shit
\setlength{\parindent}{1.\baselineskip}

% define macros for text
\newcommand{\apogee}{\project{\acronym{APOGEE}}}
\newcommand{\sdssiii}{\project{\acronym{SDSS-III}}}
\newcommand{\thejoker}{\project{The~Joker}}
\newcommand{\thecannon}{\project{The~Cannon}}
\newcommand{\DR}{\acronym{DR13}}
\newcommand{\RC}{\acronym{RC}}
\newcommand{\RGB}{\acronym{RGB}}

% for response to referee
% \renewcommand{\resp}[1]{#1}

\shortauthors{Price-Whelan et al.}

\begin{document}\sloppy\sloppypar\raggedbottom\frenchspacing % trust me

\title{Binary companions of red clump stars}

\author{Adrian~M.~Price-Whelan}
\affiliation{Department of Astrophysical Sciences,
             Princeton University, Princeton, NJ 08544, USA}
\email{adrn@astro.princeton.edu}
\correspondingauthor{Adrian M. Price-Whelan}

\author{David~W.~Hogg}
\affiliation{Center for Cosmology and Particle Physics,
             Department of Physics,
             New York University, 726 Broadway,
             New York, NY 10003, USA}
\affiliation{Max-Planck-Institut f\"ur Astronomie,
             K\"onigstuhl 17, D-69117 Heidelberg, Germany}
\affiliation{Flatiron Institute,
             Simons Foundation,
             162 Fifth Avenue,
             New York, NY 10010, USA}

\author{Hans-Walter~Rix}
\affiliation{Max-Planck-Institut f\"ur Astronomie,
             K\"onigstuhl 17, D-69117 Heidelberg, Germany}

\begin{abstract}\noindent % trust me
% Context
Radial-velocity measurements can be used to find stellar, sub-stellar,
and planetary companions of stars.
In the \apogee\ survey, we have multi-epoch radial-velocity measurements
for many red-giant stars, including many red-clump (\RC) stars.
Spectral analysis of \RC\ stars can be used to deliver masses (with
XXX precision) and 20-ish chemical abundance measurements (with YYY
precision).
% Aims
Here we perform a search for secondary companions of [number] \RC\ stars.
Because the primary-star masses are known, the mass-function degeneracy
is broken and the secondary-companion $m\,\sin i$ values can be inferred.
Also, if the primary and companion are assumed to be co-eval, the
abundances of the \RC\ star can be assumed to represent accurately the
abundances of the secondary.
% Methods
We use a data-driven model (\thecannon) of stellar spectra to deliver
each \RC\ mass and chemical abundances, and a custom-built Monte Carlo
sampler (\thejoker) to deliver (often highly multi-modal) posterior
beliefs about companion $m\,\sin i$, period, and other orbital parameters.
Our sampler permits us to accurately sample even the badly behaved
posterior pdfs obtained when there are as few an NNN observation
epochs per star.
We put these posterior samples---made under an interim prior---into a
hierarchical inference to obtain individual-companion-marginalized
posterior beliefs about the properties of the full secondary-companion
distribution in mass and period.
In this analysis, even stars with only a few observations (and therefore
badly multimodal posterior pdfs) contribute valuable information to the
population inference.
% Results
We deliver a catalog of QQQ companions [that meet some criteria], and
posterior samplings for all [number] stars in the parent sample.
We find that the period and mass distributions [have some properties].
We look for trends with chemical abundances, and we find tentative evidence
for ZZZ and WWW.
\end{abstract}

\keywords{
  binaries:~spectroscopic
  ---
  methods:~data~analysis
  ---
  methods:~statistical
  ---
  planets~and~satellites:~fundamental~parameters
  ---
  surveys
  ---
  techniques:~radial~velocities
}

\section{Introduction} \label{sec:intro}

If we want to use a spectroscopic survey to responsibly measure the
binary-star population---that is, if we want to get (say) the mass,
mass ratio, and period distribution of binary-star systems---we face
(at least) two challenges.
The first is how, given a small number of observations of a primary
star (a single-lined spectroscopic binary star), do we reliably obtain posterior
information about the binary-system properties?
After all, if there are only a few radial-velocity measurements made
per star, any observed radial-velocity values will be consistent with
many different combinations of period and amplitude (not to mention
eccentricity and argument of perihelion) for the primary orbit.
In general, the likelihood function, and the posterior pdf under any
reasonable prior pdf, will be highly multimodal in these kinds of
problems, and many of the modes will have comparable integrated
probability density.
We have solved this problem previously, though with limitations (to be
discussed more below), with \thejoker\ (CITE).
\thejoker\ is a Simple Monte Carlo rejection sampler that is
computationally expensive but probabilistically righteous: It delivers
independent (zero-auto-correlations) posterior pdf samples for
single-companion binary model parameters, given any number of
radial-velocity measurements.

The second challenge is how, given all these noisy, multi-modal
posterior pdfs over binary-system properties, many of which will
permit a wide range of qualitatively different system properties, and
many of which will be consistent with no companion at all, can we
constrain parameters of a model of the full binary-system population?
No histogram of best-fit values, nor stack of multi-modal posteriors,
would be anything like a good estimate of the true population
distribution.
We have also solved this problem previously, though in the exoplanet
domain, with hierarchical probabilistic models based on importance
sampling (CITE DFM, and also HOGG).
These hierarchical models derive posterior estimates of the population
parameters that accurately describe the population, given the noisy
information about the individual systems, provided that the noise
model is accurate---that is, provided that the likelihood functions
used in the individual-system inferences are themselves accurate.

Here we mash up these two solutions to these two challenges.
We deliver a catalog of binary-star systems with \RC\ primaries, and also
posterior information about the full population statistics, for at least
a toy model of that full population.
We use all the data---even the non-detections, marginal detections, and
badly multi-modal posterior pdfs---when we infer the population model;
that is, we don't arbitrarily cut to a catalog of ``clean'' binaries.

For the study of single-line binaries, red-giant stars---and even
better red-clump stars---are ideal.
For one, because they are so luminous, they are unlikely (in general)
to have equally-bright companions, and therefore are well approximated
or fit as single-line objects.
For two, they are standard candles, or can be distance-calibrated.
For three, they have masses that can be estimated spectrally (making
use of dredged-up elements; CITE MARTIG and CITE NESS).
With primary-star mass estimates, the binary-orbit fitting will return
$m\,\sin i$ estimates for the secondary, and not just mass-function
estimates.
For four, the \apogee\ pipelines, and also \thecannon\, produce
detailed abundance estimates for red giants and \RC\ stars.
If there are causal relationships between chemical abundances and
binary companions---and we expect there will be---these should become
visible here.

HOGG: Why and how does \apogee\ rock it?

HOGG: What is up with delivering a catalog (it requires decision-making)?

\section{Data}

Overview of what \apogee\ is, and what data we are using.

How we updated the individual-visit radial velocity measurements.

What we did (if anything) with the missing visits.

\section{Method: Detection and orbit fitting}\label{sec:fitting}

APW: Should we start this section with a set of named assumptions, as we
did in Anderson et al?

Summary of \thejoker\ and what it does.

Any modifications or knob-settings for \thejoker?

\section{A catalog of red-clump binary systems}

\section{Method: Population inferences}\label{sec:popinference}

Now we want to take the individual-star fits---or samplings---that
we made in \sectionname~\ref{sec:fitting} and, from these, produce
an inference of the properties of the whole \RC\ binary-star population.
Important necessary properties of this inference are the following:
\begin{description}
\item[foo] whatevs
\item[bar] and other
\end{description}
We can meet these requirements with a hierarchical Bayesian inference
(hierarchical probablistic model) of the binary-star population.

In addition to the above requirements, we make the following assumptions
that restrict our attention to a well-defined model space:
\begin{description}
\item[foo] whatevs
\item[bar] and other
\end{description}

The binary-system parameters for each individual \RC\ star were
inferred (in \sectionname~\ref{sec:fitting}) with an interim prior that
is very simple and doesn't represent our true beliefs about the
binary-star population...

In a hierarchical Bayesian inference, we replace the binary-star
system priors used in \sectionname~\ref{sec:fitting} with a parameterized
model for the binary-star population...

Because all we have is a sampling of each system under the interim prior,
we have to re-weight or importance-sample the individual-star samplings
in this hierarchical inference... Cite Hogg et al; Cite DFM et al.

\section{The population of red-clump binary companions}

\section{Discussion}

\acknowledgements

It is a pleasure to thank XX.

The authors are pleased to acknowledge that the work reported on in this
paper was substantially performed at the TIGRESS high performance computer
center at Princeton University which is jointly supported by the Princeton
Institute for Computational Science and Engineering and the Princeton
University Office of Information Technology's Research Computing department.

\software{
The code used in this project is available from
\url{https://github.com/adrn/TwoFace} under the MIT open-source
software license.
This research utilized the following open-source \python\ packages:
    \package{Astropy} (\citealt{Astropy-Collaboration:2013}),
    % \package{corner} (\citealt{Foreman-Mackey:2016}),
    % \package{emcee} (\citealt{Foreman-Mackey:2013ascl}),
    \package{IPython} (\citealt{Perez:2007}),
    \package{matplotlib} (\citealt{Hunter:2007}),
    \package{numpy} (\citealt{Van-der-Walt:2011}),
    \package{scipy} (\url{https://www.scipy.org/}),
    \package{sqlalchemy} (\url{https://www.sqlalchemy.org/}).
}

\facility{\sdssiii, \apogee}

\bibliographystyle{aasjournal}
\bibliography{refs}

\end{document}
